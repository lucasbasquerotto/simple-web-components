/*! Built with http://stenciljs.com */
SimpleWebComponents.loadBundle("9qj2lnbu",["exports"],function(t){var e=window.SimpleWebComponents.h,n=function(){function t(){this.count=0,this.amount=4e4,this.intervals=[3e3,6e3],this.items=this.createItems()}return t.prototype.updateItems=function(t){console.log("updateItems",t,(this.items||[]).length),this.scrollItems=t},t.prototype.createItems=function(){var t=this.count*this.amount+1;this.count++;var e=(this.items||[]).concat(".".repeat(this.amount).split("").map(function(e,n){return{name:"item-"+(n+t),text:"Item "+(n+t)}}));return console.log("createItems",e.length),e},t.prototype.componentDidLoad=function(){for(var t=this,e=0,n=this.intervals||[];e<n.length;e++){var o=n[e];setTimeout(function(){return t.items=t.createItems()},o)}},t.prototype.render=function(){var t=this;return e("div",null,"Hello, World! I'm ",this.first," ",this.last,e("br",null),e("sp-virtual-scroll",{items:this.items,onUpdate:function(e){return t.updateItems(e)},onVirtualChange:function(t){return console.log("onVirtualChange",t)},onStart:function(t){return console.log("onStart",t)},onEnd:function(t){return console.log("onEnd",t)},parentScroll:this.el,buffer:10},(this.scrollItems||[]).map(function(t){return e("div",{class:t.name,style:{width:"100%"}},e("div",{style:{width:"100%"}},t.text),t.text.split("").map(function(t){return e("div",{style:{width:"100%"}},"|",t,"|")}))})),"Hello, World! I'm ",this.first," ",this.last,e("br",null))},Object.defineProperty(t,"is",{get:function(){return"my-component"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{el:{elementRef:!0},first:{type:String,attr:"first"},items:{state:!0},last:{type:String,attr:"last"},scrollItems:{state:!0}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"[data-my-component-host]{display:block;position:relative;height:100%;overflow-y:auto}"},enumerable:!0,configurable:!0}),t}(),o=function(){function t(){this.items=[],this.buffer=0,this.scrollAnimationTime=1500,this.cumulativeHeights=[],this.showAmountLoop=new Set,this.totalScrollHeight=-1,this.lastTopPadding=-1,console.log("virtual-scroll")}return t.prototype.componentWillLoad=function(){console.log("componentWillLoad"),this.addParentEventHandlers(this.parentScroll||this.el)},t.prototype.componentDidLoad=function(){console.log("componentDidLoad"),this.refresh()},t.prototype.componentDidUnload=function(){this.removeParentEventHandlers()},t.prototype.componentWillUpdate=function(){console.log("componentWillUpdate"),this.refresh()},t.prototype.refresh=function(t){var e=this;void 0===t&&(t=!1),window.requestAnimationFrame(function(){return e.calculateItems(t)})},t.prototype.addParentEventHandlers=function(t){var e=this;if(this.removeParentEventHandlers(),console.log("parentScroll"),t){var n=function(){return e.refresh()};t.addEventListener("scroll",n),this.disposeScrollHandler=function(){return t.removeEventListener("scroll",n)}}},t.prototype.removeParentEventHandlers=function(){this.disposeScrollHandler&&(this.disposeScrollHandler(),this.disposeScrollHandler=void 0)},t.prototype.getContent=function(){return this.el.shadowRoot.querySelector(".scrollable-content")},t.prototype.getShimElement=function(){return this.el.shadowRoot.querySelector(".total-padding")},t.prototype.calculateItems=function(t){void 0===t&&(t=!1);var e=this.calculateValues(),n=e.start,o=void 0===n?0:n,r=e.startBuffer,i=void 0===r?0:r,l=e.end,s=void 0===l?0:l,a=e.endBuffer,c=void 0===a?0:a;if(o!==this.previousStart||s!==this.previousEnd||!0===t){var u=this.items||[];this.viewPortItems=u.slice(i,c),this.onUpdate&&this.onUpdate(this.viewPortItems),console.log("slice",o,s,i,c),o!==this.previousStart&&0===o&&this.onStart&&this.onStart({start:o,end:s}),s!==this.previousEnd&&s===u.length-1&&this.onEnd&&this.onEnd({start:o,end:s}),this.previousStart=o,this.previousStartBuffer=i,this.previousEnd=s;var h=s-o;if(!this.showAmountLoop.has(h))return this.showAmountLoop.add(h),this.refresh()}this.showAmountLoop.clear()},t.prototype.calculateValues=function(){var t=this.parentScroll||this.el,e=t.scrollTop,n=this.el.children,o=(this.items||[]).length,r=this.parentScroll?this.el.offsetTop:0,i=Math.max(0,(this.totalScrollHeight||0)-r),l=Math.max(0,e-r),s=t.clientHeight||0,a=0,c=0,u=0;if(n&&n.length){var h=this.previousStartBuffer||0,p=h,d=this.cumulativeHeights||[],m=d.length,f=0;if(m<p){m>0&&(f=d[m-1]);for(var g=m;g<p;g++)f+=u,d[g]=f;m=d.length}p&&(f=d[p-1]),console.log("current0",p,h);for(var v=0,y=Array.from(n);v<y.length;v++)f+=y[v].getBoundingClientRect().height||u,d[p]=f,p++;for(u=Math.max(f/p,1),console.log("current1",p);l+s>f&&p<o;)f+=u,d[p]=f,p++;console.log("cumulativeHeight",f,d.length,p),this.cumulativeHeights=d.slice(0,p),m=d.length;for(var b=0,S=0,H=0;b<m&&(S=H,!((H=d[b])>=l));)b++;for(a=b+(l-S)/(H-S);b<m&&(S=H,!((H=d[b])>=l+s));)b++;var w=b+(l+s-S)/(H-S);c=Math.ceil(w-a)}c=Math.max(c,0);var M=Math.max(0,this.buffer||0);o&&!c&&(c=Math.max(M,2));var P=Math.min(Math.ceil(a)+c,o),E=Math.min(P,Math.floor(a));E=Math.max(0,E||0),E=Math.min(E,o);var I=Math.min(E+c,o),x=E-M-1;x=Math.max(0,x);var A=I+M+1;A=Math.min(A,o);var L=this.cumulativeHeights[x-1]||0;if(L!==this.lastTopPadding){var C=this.getContent();C.style.transform="translateY("+L+"px)",C.style.webkitTransform="translateY("+L+"px)",this.lastTopPadding=L}i=u*o;var j=Math.max(0,i+r);return j!==this.totalScrollHeight&&(this.getShimElement().style.height=i+"px",this.totalScrollHeight=i,console.log("totalScrollHeight",j,i,o)),console.log("calc",E,x,I,A,c,l,i),{start:E,startBuffer:x,end:I,endBuffer:A,showCount:c}},t.prototype.render=function(){return[e("div",{class:"total-padding"}),e("div",{class:"scrollable-content"},e("slot",null))]},Object.defineProperty(t,"is",{get:function(){return"sp-virtual-scroll"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{buffer:{type:Number,attr:"buffer"},el:{elementRef:!0},items:{type:"Any",attr:"items"},onEnd:{type:"Any",attr:"on-end"},onStart:{type:"Any",attr:"on-start"},onUpdate:{type:"Any",attr:"on-update"},onVirtualChange:{type:"Any",attr:"on-virtual-change"},parentScroll:{type:"Any",attr:"parent-scroll"},scrollAnimationTime:{type:Number,attr:"scroll-animation-time"}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"[data-sp-virtual-scroll-host]{overflow:hidden;overflow-y:hidden;position:relative;display:block;-webkit-overflow-scrolling:touch}.scrollable-content[data-sp-virtual-scroll]{top:0;left:0;width:100%;height:100%;position:absolute}.total-padding[data-sp-virtual-scroll]{width:1px;opacity:0}"},enumerable:!0,configurable:!0}),t}();t.MyComponent=n,t.SpVirtualScroll=o,Object.defineProperty(t,"__esModule",{value:!0})});